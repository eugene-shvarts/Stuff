<!DOCTYPE html>
<!-- saved from url=(0046)http://sta250.github.io/Stuff/Homework_04.html -->
<html style=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>STA 250 :: Advanced Statistical Computing (UCD, Fall 2013) by STA250</title>
    <link rel="stylesheet" href="http://sta250.github.io/Stuff/stylesheets/hwstyles.css">
    <link rel="stylesheet" href="http://sta250.github.io/Stuff/stylesheets/pygment_trac.css">
    <script src="./Homework_04_files/jquery.min.js"></script>
    <script src="./Homework_04_files/respond.js"></script>
    <script type="text/javascript" src="./Homework_04_files/MathJax.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  <style type="text/css"></style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">/**
 * Style sheet used by new LibX tooltip code
 */

/* We insert a <div> with libx-tooltip style under the body.
 * This will inherit body's style - we can't afford to inherit undesirable 
 * styles and we must redefine what we need.  OTOH, some things, e.g.
 * font-size, might be ok to be inherited to stay within the page's tone.
 */
.libx-tooltip {
    display: none;
    overflow: visible;
    padding: 5px;
    z-index: 100;
    background-color: #eee;
    color: #000;
    font-weight: normal;
    font-style: normal;
    text-align: left;
    border: 2px solid #666;
    border-radius: 5px;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
}

.libx-tooltip p {
    /* override default 1em margin to keep paragraphs inside a tooltip closer together. */
    margin: .2em;
}
</style><style type="text/css">/**
 * Style sheet used by LibX autolinking code
 */
.libx-autolink {
}

</style><style type="text/css">div.jGrowl {
	padding: 			10px;
	z-index: 			9999;
}

/** Special IE6 Style Positioning **/
div.ie6 {
	position: 			absolute;
}

div.ie6.top-right {
	right: 				auto;
	bottom: 			auto;
	left: 				expression( ( 0 - jGrowl.offsetWidth + ( document.documentElement.clientWidth ? document.documentElement.clientWidth : document.body.clientWidth ) + ( ignoreMe2 = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft ) ) + 'px' );
  	top: 				expression( ( 0 + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' );
}

div.ie6.top-left {
	left: 				expression( ( 0 + ( ignoreMe2 = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft ) ) + 'px' );
	top: 				expression( ( 0 + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' );
}

div.ie6.bottom-right {
	left: 				expression( ( 0 - jGrowl.offsetWidth + ( document.documentElement.clientWidth ? document.documentElement.clientWidth : document.body.clientWidth ) + ( ignoreMe2 = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft ) ) + 'px' );
	top: 				expression( ( 0 - jGrowl.offsetHeight + ( document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight ) + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' );
}

div.ie6.bottom-left {
	left: 				expression( ( 0 + ( ignoreMe2 = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft ) ) + 'px' );
	top: 				expression( ( 0 - jGrowl.offsetHeight + ( document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight ) + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' );
}

div.ie6.center {
	left: 				expression( ( 0 + ( ignoreMe2 = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft ) ) + 'px' );
	top: 				expression( ( 0 + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' );
	width: 				100%;
}

/** Normal Style Positions **/
body > div.jGrowl {
	position:			fixed;
}

body > div.jGrowl.top-left {
	left: 				0px;
	top: 				0px;
}

body > div.jGrowl.top-right {
	right: 				0px;
	top: 				0px;
}

body > div.jGrowl.bottom-left {
	left: 				0px;
	bottom:				0px;
}

body > div.jGrowl.bottom-right {
	right: 				0px;
	bottom: 			0px;
}

body > div.jGrowl.center {
	top: 				0px;
	width: 				50%;
	left: 				25%;
}

/** Cross Browser Styling **/
div.center div.jGrowl-notification, div.center div.jGrowl-closer {
	margin-left: 		auto;
	margin-right: 		auto;
}

div.jGrowl div.jGrowl-notification, div.jGrowl div.jGrowl-closer {
	background-color: 		#ccc;
	color: 					#000;
	opacity: 				.95;
	filter: 				alpha(opacity = 95);
	zoom: 					1;
	/* width: 					235px; */
	padding: 				10px;
	margin-top: 			5px;
	margin-bottom: 			5px;
	font-family: 			Tahoma, Arial, Helvetica, sans-serif;
	font-size: 				12px;
	text-align: 			left;
	display: 				none;
	-moz-border-radius: 	5px;
	-webkit-border-radius:	5px;
}

div.jGrowl div.jGrowl-notification {
	min-height: 			40px;
}

div.jGrowl div.jGrowl-notification div.header {
	font-weight: 			bold;
	font-size:				10px;
}

div.jGrowl div.jGrowl-notification div.close {
	float: 					right;
	font-weight: 			bold;
	font-size: 				12px;
	cursor:					pointer;
}

div.jGrowl div.jGrowl-closer {
	height: 				15px;
	padding-top: 			4px;
	padding-bottom: 		4px;
	cursor: 				pointer;
	font-size:				11px;
	font-weight: 			bold;
	text-align: 			center;
}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0 !important; padding: 0 !important; margin: 0 !important; vertical-align: 0 !important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap ! important}
.MathJax img {display: inline ! important; float: none ! important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block; overflow: hidden; width: 1px; height: 60ex}
.MathJax .MathJax_EmBox {display: block; overflow: hidden; width: 1px; height: 60em}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('http://cdn.mathjax.org/mathjax/2.3-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
  <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/STA250/Stuff">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/STA250/Stuff/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/STA250/Stuff/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <a href="http://sta250.github.io/Stuff"><h1>STA 250 :: Advanced Statistical Computing (UCD, Fall 2013)</h1></a>
          <p>Code + goodies used in Prof. Baines' STA 250 Course (UC Davis, Fall 2013)</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/STA250">STA250</a></span>
          <span class="credits right">Hosted on GitHub Pages — Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

<style type="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>

<h1><a name="stuff" class="anchor" href="http://sta250.github.io/Stuff/Homework_04.html#stuff"><span class="octicon octicon-link"></span></a>STA 250 :: Homework Policy</h1>

<p><em>For all questions you must show your work. This enables us to understand your thought process, give partial credit and prevent crude cheating. Please see the code of the conduct in the Syllabus for rules about collaborating on homeworks.</em></p>
<p><em>For questions requiring computing, if you use <code>R</code>, <code>python</code> or any programming environment then you must turn in a printout of your output with your solutions.<br>In addition, a copy of your code must be uploaded to the appropriate <code>HW</code> directory of your forked GitHub repo within 24 hours of the homework due date.</em></p>
<p><br></p>

<h2>Homework 04</h2>
<h2>Due: In Class, Fri December 6th</h2>
<h4>Assigned: Wednesday November 27th</h4>
<h4>GPU Module</h4>
<p>(<a href="http://sta250.github.io/Stuff/plain/Homework_04_plain.html">Click here for printable version</a>)</p>
<p>
In this homework you will implement several calculations using both 
the CPU and GPU. For the GPU-related problems, you are welcome to 
use either R (RCUDA), Python (PyCUDA) or C (CUDA C). 
</p>
<ol start="0">
    <li>Sync your fork of the course GitHub repo to include the latest updates using the instructions provided <a href="http://sta250.github.io/Stuff/sync_fork.html">here</a>.</li>
    <br><br>
    
    <li>
    In this question, you will implement a kernel to obtain samples from a truncated normal random variable, and test your code.
    <ol type="a">

    <!-- ##### (a) ##### -->
    <li>Write a kernel in CUDA C to obtain samples from a truncated normal random variable of the form:
    <span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 23.448em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.897em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.365em 1000.003em 4.496em -0.516em); top: -3.684em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.291em;">∼</span><span class="texatom" id="MathJax-Span-5" style="padding-left: 0.291em;"><span class="mrow" id="MathJax-Span-6"><span class="mtext" id="MathJax-Span-7" style="font-family: MathJax_Main;">TN</span></span></span><span class="mrow" id="MathJax-Span-8"><span class="mo" id="MathJax-Span-9" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-12" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.82em; left: 0.694em;"><span class="texatom" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="mn" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">;</span><span class="mrow" id="MathJax-Span-18" style="padding-left: 0.176em;"><span class="mo" id="MathJax-Span-19" style=""><span style="font-family: MathJax_Main;">(</span></span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.176em;">b</span><span class="mo" id="MathJax-Span-23" style=""><span style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-24" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.291em;">≡</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.291em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-30" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.82em; left: 0.694em;"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mn" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-36"><span style="display: inline-block; position: relative; width: 3.92em; height: 0px;"><span style="position: absolute; clip: rect(1.961em 1000.003em 2.941em -0.458em); top: -2.762em; left: 0.003em;"><span class="texatom" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="mn" id="MathJax-Span-39" style="font-family: MathJax_Main; font-weight: bold;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.768em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.579em;"><span class="texatom" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mo" id="MathJax-Span-43" style="vertical-align: 0.06em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">{</span></span></span><span class="mi" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mrow" id="MathJax-Span-46"><span class="mo" id="MathJax-Span-47" style="vertical-align: 0.06em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">(</span></span></span><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-51" style="vertical-align: 0.06em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">)</span></span></span></span><span class="mo" id="MathJax-Span-52" style="vertical-align: 0.06em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">}</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span></span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 3.69em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.361em; vertical-align: -0.854em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">
    X \sim \textrm{TN}\left(\mu,\sigma^{2};\left(a,b\right)\right) \equiv N(\mu,\sigma^{2})\mathbf{1}_{\left\{X\in\left(a,b\right)\right\}} .
    </script>
    Your function should have (roughly) the following structure:<br><br>
    <pre><code>
    #include &lt;stdio.h&gt;
    #include &lt;stdlib.h&gt;
    #include &lt;cuda.h&gt;
    #include &lt;curand_kernel.h&gt;
    #include &lt;math_constants.h&gt;

    extern "C"
    {

    __global__ void
    truncnorm_kernel(
      float *x,      // Vector to contain returned samples 
      int n,         // Number of samples to return
      float *mu,     // Vector of mu's
      float *sigma,  // Vector of sigma's
      float *a,      // Vector of lower-truncation values
      float *b)      // Vector of upper-truncation values
    {
        // CODE ... blah
        return;
    }

    } // END extern "C"

    </code></pre>
    Important notes:
    <ul>
        <li>In the above prototype, the function is vectorized for all arguments i.e., <code>mu</code>, <code>sigma</code>, <code>a</code> and <code>b</code> are all vectors. You could add more arguments to allow for recycling of scalar arguments if desired.</li>
        <li>The above format provides the simplest interface i.e., each RNG needs to be initialized within the thread (unless you do something more sophisticated). If you want to develop more efficient code then consider passing in the pre-initialized random number generator states (and the number of RNGs). However, I strongly urge you to implement a simple version first and get it working before trying to optimize for speed.</li>
        <li>As explained in class, the inverse-CDF method is feasible, but requires that you create a `__device__` function for both the CDF and inverse CDF of a normal distribution.</li>
        <li>The simplest sampling method to implement is rejection sampling, for which you will want to specify the maximum number of attempts. This method will work well in most settings.</li>
        <li>For truncation regions in the tail of the distribution rejection sampling may be either inefficient or infeasible, so you will require fall back code for these cases. One option is to implement the algorithms in <a href="http://arxiv.org/pdf/0907.4010.pdf">Robert (2009)</a>. Another, simpler option is to implement a simpler but less accurate approximate method discussed in class. Note that ideally, given more time, the methods in the Robert paper are far superior to the approximate methods discussed.</li>
        <li>To select the grid/block dimensions it is recommend to use the function inside `utility.R` in the GitHub repo.</li>
    </ul>
    </li>

    <!-- ##### (b) ##### -->
    <li>Compile your CUDA kernel using <code>nvcc</code> and check it can be launched properly.</li>
    <p> The basic steps for doing this in <code>RCUDA</code> are as follows:</p>
    <ul>
      <li>Compile to ptx with `nvcc --ptx -o rtruncnorm.ptx rtruncnorm.c`</li>
    	<li>Use `loadModule` to load in the ptx file</li>
      <li>Copy a vector to the device to store the samples</li>
      <li>Select the grid/block dimensions</li>
      <li>Launch the kernel with `.cuda`</li>
      <li>Copy the samples back to the CPU via `[]` or `copyFromDevice`</li>
    </ul>
    
    <!-- ##### (c) ##### -->
    <li>Sample 10,000 random variables from <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-54" style="width: 9.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.491em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.789em 1000.003em 3.113em -0.516em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-59" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-61" style="font-family: MathJax_Main; padding-left: 0.176em;">1</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">;</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.176em;">(</span><span class="mn" id="MathJax-Span-64" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.176em;">1.5</span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.354em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">TN(2,1;(0,1.5))</script>, and verify the expected value (roughly) matches the theoretical value (see class notes for details).</li>

    <!-- ##### (d) ##### -->
    <li>Write an R/Python/C function for sampling truncated normal random variables (possibly using a different algorithm). You may also use the code provide in the GitHub repo. Sample 10,000 random variables from this function and verify the mean (roughly) matches the theoretical values.</li>

    <!-- ##### (e) ##### -->
    <li>Time your (R/Py/C)CUDA function and pure R/Python/C function for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-69" style="width: 4.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.401em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.673em 1000.003em 2.883em -0.516em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-70"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-73" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 1.443em; height: 0px;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.458em); top: -2.704em; left: 0.003em;"><span class="mn" id="MathJax-Span-74" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span><span style="position: absolute; top: -2.762em; left: 1.04em;"><span class="texatom" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.365em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">n=10^{k}</script> for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-78" style="width: 7.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.109em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 3.056em -0.458em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-82" style="font-family: MathJax_Main; padding-left: 0.291em;">1</span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.176em;">2</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.176em;">…</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main; padding-left: 0.176em;">,</span><span class="mn" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.176em;">8</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">k=1,2,\ldots,8</script>. Plot the total runtimes for both functions on the y-axis as a function of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-89" style="width: 0.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.653em -0.516em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.718em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">n</script> (on the log-scale as the x-axis). At what point did/do you expect the GPU function to outperform the non-GPU function? You may also want to decompose the GPU runtimes into copy to/kernel/copy back times for further detailed analysis.</li>

    <!-- ##### (f) ##### -->
    <li>Verify that both your GPU and CPU code work for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-92" style="width: 4.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.574em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.077em 1000.003em 2.883em -0.458em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.291em;">−</span><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Main;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.718em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">a=-\infty</script> and/or <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-98" style="width: 4.323em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.459em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.941em -0.458em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main; padding-left: 0.291em;">+</span><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Main;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.075em; vertical-align: -0.139em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">b=+\infty</script>.</li>

    <!-- ##### (g) ##### -->
    <li>Verify that both your GPU and CPU code work for truncation regions in the tail of the distribution e.g., <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-104" style="width: 16.593em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.367em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 3.113em -0.458em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.291em;">−</span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Main;">∞</span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.176em;">b</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.291em;">−</span><span class="mn" id="MathJax-Span-114" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.176em;">μ</span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.291em;">0</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.176em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.291em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.354em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">a=-\infty,b=-10,\mu=0,\sigma=1</script>.</li>

    </ol>
    </li>

    <br><br>
    <li>In this question you will implement Probit MCMC i.e., fitting a Bayesian Probit regression model using MCMC. This model turns out to be computationally nice and simple, lending itself to a Gibbs sampling algorithm with each distribution available in sample-able form. The model is as follows:
    <span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-9-Frame" style=""><nobr><span class="math" id="MathJax-Span-123" style="width: 100%; display: inline-block; min-width: 9.45em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(4.323em 1000.003em 8.931em -0.516em); top: -5.239em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.056em 1000.003em 4.669em -0.458em); top: -3.972em; left: 50%; margin-left: -3.338em;"><span class="msubsup" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.176em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.186em; left: 0.637em;"><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.365em;"></span></span></span></span><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-131"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.186em; left: 0.752em;"><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.365em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.291em;">∼</span><span class="msubsup" id="MathJax-Span-135" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 3.056em; height: 0px;"><span style="position: absolute; clip: rect(1.961em 1000.003em 2.941em -0.458em); top: -2.762em; left: 0.003em;"><span class="texatom" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mn" id="MathJax-Span-138" style="font-family: MathJax_Main; font-weight: bold;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.768em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.579em;"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mo" id="MathJax-Span-142" style="vertical-align: 0.06em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">{</span></span></span><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 0.694em; height: 0px;"><span style="position: absolute; clip: rect(1.731em 1000.003em 2.537em -0.458em); top: -2.359em; left: 0.003em;"><span class="mi" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.365em;"></span></span><span style="position: absolute; top: -2.186em; left: 0.521em;"><span class="texatom" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="mi" id="MathJax-Span-147" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.307em;"></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span><span class="mn" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-150" style="vertical-align: 0.06em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">}</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(2.998em 1000.003em 4.438em -0.516em); top: -2.186em; left: 50%; margin-left: -3.799em;"><span class="mo" id="MathJax-Span-151"></span><span class="msubsup" id="MathJax-Span-152"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.186em; left: 0.752em;"><span class="mi" id="MathJax-Span-154" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.365em;"></span></span></span></span><span class="texatom" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main; padding-left: 0.291em;">∼</span><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.291em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-162"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; clip: rect(1.731em 1000.003em 2.537em -0.516em); top: -2.704em; left: 0.579em;"><span class="texatom" id="MathJax-Span-164"><span class="mrow" id="MathJax-Span-165"><span class="mi" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.365em;"></span></span><span style="position: absolute; clip: rect(1.731em 1000.003em 2.537em -0.516em); top: -2.071em; left: 0.579em;"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.365em;"></span></span></span></span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-172" style="font-family: MathJax_Main; padding-left: 0.176em;">1</span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.056em 1000.003em 4.381em -0.516em); top: -0.746em; left: 50%; margin-left: -3.223em;"><span class="mo" id="MathJax-Span-174"></span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main; padding-left: 0.291em;">∼</span><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.291em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-179"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.825em -0.516em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.186em; left: 0.637em;"><span class="mn" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-183" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.458em); top: -2.704em; left: 0.003em;"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span><span style="position: absolute; top: -2.244em; left: 0.694em;"><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main;">,</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.245em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.432em; vertical-align: -4.425em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-9"> Y_i | Z_i \sim \mathbf{1}_{\left\{Z_{i}>0\right\}} \\
       Z_i | \beta \sim N(x_{i}^{T}\beta,1) \\
       \beta \sim N(\beta_0,\Sigma_0) ,
    </script>
    where <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-188" style="width: 1.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.443em 1000.003em 2.71em -0.516em); top: -2.301em; left: 0.003em;"><span class="mrow" id="MathJax-Span-189"><span class="msubsup" id="MathJax-Span-190"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.825em -0.516em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.186em; left: 0.637em;"><span class="mn" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.307em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.354em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\beta_0</script> is a <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-193" style="width: 2.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.249em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 3.056em -0.573em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-194"><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main; padding-left: 0.233em;">×</span><span class="texatom" id="MathJax-Span-197" style="padding-left: 0.233em;"><span class="mrow" id="MathJax-Span-198"></span></span><span class="mn" id="MathJax-Span-199" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">p\times{}1</script> vector corresponding to the prior mean, and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-200" style="width: 2.077em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.673em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.27em 1000.003em 2.768em -0.458em); top: -2.301em; left: 0.003em;"><span class="mrow" id="MathJax-Span-201"><span class="msubsup" id="MathJax-Span-202"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.458em); top: -2.704em; left: 0.003em;"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span><span style="position: absolute; clip: rect(1.789em 1000.003em 2.595em -0.458em); top: -2.82em; left: 0.694em;"><span class="texatom" id="MathJax-Span-204"><span class="mrow" id="MathJax-Span-205"><span class="mo" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span><span style="position: absolute; clip: rect(1.789em 1000.003em 2.595em -0.516em); top: -2.186em; left: 0.694em;"><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mn" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.307em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.575em; vertical-align: -0.425em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\Sigma_{0}^{-1}</script> is the prior precision matrix. Note that for convenience we supply <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-211" style="width: 2.077em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.673em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.27em 1000.003em 2.768em -0.458em); top: -2.301em; left: 0.003em;"><span class="mrow" id="MathJax-Span-212"><span class="msubsup" id="MathJax-Span-213"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.458em); top: -2.704em; left: 0.003em;"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span><span style="position: absolute; clip: rect(1.789em 1000.003em 2.595em -0.458em); top: -2.82em; left: 0.694em;"><span class="texatom" id="MathJax-Span-215"><span class="mrow" id="MathJax-Span-216"><span class="mo" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-218" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span><span style="position: absolute; clip: rect(1.789em 1000.003em 2.595em -0.516em); top: -2.186em; left: 0.694em;"><span class="texatom" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mn" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.307em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.575em; vertical-align: -0.425em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\Sigma_{0}^{-1}</script> as an argument to the probit MCMC function, to allow for flat priors for <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-222" style="width: 0.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.637em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.825em -0.516em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\beta</script>.
    </li>

    <ol type="a">

    <!-- ##### (a) ##### -->
    <li>Write a C/R/Python function `probit_mcmc` to sample from the posterior distribution of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-225" style="width: 0.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.637em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.825em -0.516em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\beta</script> using the CPU only. The recommended function prototype is:
    <pre><code>
    probit_mcmc_cpu(
      y,           # vector of length n 
      X,           # (n x p) design matrix
      beta_0,      # (p x 1) prior mean
      Sigma_0_inv, # (p x p) prior precision 
      niter,       # number of post burnin iterations
      burnin      # number of burnin iterations
      )
    </code></pre>
    Your function should return the posterior samples of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-228" style="width: 0.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.637em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.825em -0.516em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-229"><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">\beta</script> as a matrix/array or `mcmc` object (if using `R`). The posterior samples of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-231" style="width: 1.04em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">Z</script> do not need to be returned (and should not be stored -- they will take up too much memory!).
    </li>

    <li>Write a R/Py/C(CUDA) function `probit_mcmc` to sample from the posterior distribution of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-234" style="width: 0.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.637em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.825em -0.516em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-235"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\beta</script> using the CPU and GPU. The recommended function prototype is:
    <pre><code>
    probit_mcmc_gpu(
      y,           # vector of length n 
      X,           # (n x p) design matrix
      beta_0,      # (p x 1) prior mean
      Sigma_0_inv, # (p x p) prior precision 
      niter,       # number of post burnin iterations
      burnin,      # number of burnin iterations
      block_dims,  # block dimensions
      grid_dims    # grid_dimensions
      )
    </code></pre>
    You can also compute the block and grid dimensions within your function if preferred. Note that the GPU should only be used for the sampling of the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-237" style="width: 1.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.155em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.443em 1000.003em 2.653em -0.458em); top: -2.301em; left: 0.003em;"><span class="mrow" id="MathJax-Span-238"><span class="msubsup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.186em; left: 0.752em;"><span class="mi" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.365em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.307em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">Z_i</script> vector. Your function should return the posterior samples of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-242" style="width: 0.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.637em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.825em -0.516em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-243"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.289em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">\beta</script> as a matrix/array or `mcmc` object (if using `R`). The posterior samples of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-245" style="width: 1.04em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.653em -0.458em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-246"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">Z</script> do not need to be returned (and should not be stored -- they will take up too much memory!).
    </li>

    <!-- ##### (c) ##### -->
    <li>Test your code by fitting the mini dataset `mini_test.txt`. This dataset can be generated by running the file `sim_probit.R`, supplied in the course GitHub repo. The first column of the dataset corresponds to `y`, with all other columns corresponding to `X`. Assume prior parameters <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-248" style="width: 3.69em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.941em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.558em 1000.003em 3.113em -0.516em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-249"><span class="msubsup" id="MathJax-Span-250"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(1.616em 1000.003em 2.825em -0.516em); top: -2.474em; left: 0.003em;"><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span><span style="position: absolute; top: -2.186em; left: 0.637em;"><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="mn" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="texatom" id="MathJax-Span-256" style="padding-left: 0.291em;"><span class="mrow" id="MathJax-Span-257"><span class="munderover" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.458em); top: -2.704em; left: 0.003em;"><span class="mn" id="MathJax-Span-259" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span><span style="position: absolute; top: -4.26em; left: 0.06em;"><span style="height: 0.003em; vertical-align: 0.003em; width: 0.464em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0.003em; vertical-align: 0.003em; margin-left: -0.228em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.718em; vertical-align: -0.354em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\beta_{0}=\vec{0}</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-261" style="width: 4.381em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.517em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.673em 1000.003em 3.171em -0.458em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-262"><span class="msubsup" id="MathJax-Span-263"><span style="display: inline-block; position: relative; width: 1.616em; height: 0px;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.458em); top: -2.704em; left: 0.003em;"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span><span style="position: absolute; clip: rect(1.789em 1000.003em 2.595em -0.458em); top: -2.82em; left: 0.694em;"><span class="texatom" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="mo" id="MathJax-Span-267" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span><span style="position: absolute; clip: rect(1.789em 1000.003em 2.595em -0.516em); top: -2.186em; left: 0.694em;"><span class="texatom" id="MathJax-Span-269"><span class="mrow" id="MathJax-Span-270"><span class="mn" id="MathJax-Span-271" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.422em;"></span></span></span></span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-273" style="font-family: MathJax_Main; padding-left: 0.291em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.575em; vertical-align: -0.425em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\Sigma_{0}^{-1}=0</script>. Verify that both functions give posterior means/medians that are at least relatively close to the true values (in `mini_pars.txt`, also generated
    when you run `sim_probit.R`) and the estimates produced by standard GLM functions.</li>

    <!-- ##### (d) ##### -->
    <li>Run `sim_probit.R` to create each of the following datasets. Then analyze as many as possible, using both your CPU and GPU code:<br><br>
    <ol>
      <li>`data_01.txt`: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-274" style="width: 4.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.978em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.516em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-278" style="font-family: MathJax_Main; padding-left: 0.291em;">1000</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">n=1000</script> for `niter=2000`, `burnin=500`.</li>
      <li>`data_02.txt`: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-279" style="width: 5.59em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.496em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.516em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-280"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-283" style="font-family: MathJax_Main; padding-left: 0.291em;">10000</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">n=10000</script> for `niter=2000`, `burnin=500`.</li>
      <li>`data_03.txt`: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-284" style="width: 6.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.014em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.516em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-288" style="font-family: MathJax_Main; padding-left: 0.291em;">100000</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">n=100000</script> for `niter=2000`, `burnin=500`.</li>
      <li>`data_04.txt`: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-289" style="width: 6.858em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.533em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.516em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-290"><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-293" style="font-family: MathJax_Main; padding-left: 0.291em;">1000000</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">n=1000000</script> for `niter=2000`, `burnin=500`.</li>
      <li>`data_05.txt`: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-28-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-294" style="width: 7.549em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.051em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.846em 1000.003em 2.883em -0.516em); top: -2.704em; left: 0.003em;"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-298" style="font-family: MathJax_Main; padding-left: 0.291em;">10000000</span></span><span style="display: inline-block; width: 0px; height: 2.71em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">n=10000000</script> for `niter=2000`, `burnin=500`.</li>
    </ol>
    Again, the first column of each dataset corresponds to `y`, with all other columns corresponding to `X`. Record the runtimes of `probit_mcmc_cpu` and `probit_mcmc_gpu` for each of the datasets.
    <p>Note I: If your code is too slow, you may also run fewer iterations. It may take several minutes to fit each probit model using the GPU code.</p>
    <em>Not II: The number of iterations used here is not sufficient to obtain reliable posterior estimates. This exercise is for illustration and learning purposes, if you want to actually use the estimates be sure to run the chains for longer and check the usual diagnostics!</em>
    </li>

    <!-- ##### (d) ##### -->
    <li>Discuss the relative performance of your CPU and GPU code. At what point do you think your GPU code would become competitive with the CPU code?</li>

    </ol>

</ol>

<br>

<h3>(: Happy Coding! :)</h3>

      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  


<div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, sans-serif;"></div></body></html>